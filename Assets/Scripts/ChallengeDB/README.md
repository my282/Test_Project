# Challenge Database ã‚·ã‚¹ãƒ†ãƒ 

**å…¥åŠ›å¼å•é¡Œã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨å®Ÿè£…**

## ğŸ“‹ ç›®æ¬¡

- [æ¦‚è¦](#æ¦‚è¦)
- [ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ](#ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ)
- [ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](#ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ)
- [è©³ç´°ã‚¬ã‚¤ãƒ‰](#è©³ç´°ã‚¬ã‚¤ãƒ‰)
- [CSVä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆ](#csvä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆ)
- [GameDatabaseçµ±åˆï¼ˆå°†æ¥ã®æ‹¡å¼µç”¨ï¼‰](#gamedatabaseçµ±åˆå°†æ¥ã®æ‹¡å¼µç”¨)
- [API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](#api-ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹)
- [æ›´æ–°å±¥æ­´](#æ›´æ–°å±¥æ­´)

---

## æ¦‚è¦

Challenge Databaseã‚·ã‚¹ãƒ†ãƒ ã¯ã€å…¥åŠ›å¼å•é¡Œã‚’ç®¡ç†ãƒ»å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š

### ä¸»ãªæ©Ÿèƒ½

âœ… **å…¥åŠ›å¼å•é¡Œå¯¾å¿œ** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ†ã‚­ã‚¹ãƒˆã‚„æ•°å€¤ã‚’å…¥åŠ›ã—ã¦å›ç­”  
âœ… **5æ®µéšé›£æ˜“åº¦** - Beginnerï½Expertã®é›£æ˜“åº¦è¨­å®š  
âœ… **ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œ** - é›£æ˜“åº¦åˆ¥ã«ãƒ©ãƒ³ãƒ€ãƒ ã§å•é¡Œã‚’é¸æŠ  
âœ… **ç¢ºç‡å ±é…¬ã‚·ã‚¹ãƒ†ãƒ ** - ã‚¬ãƒãƒ£å½¢å¼ã®å ±é…¬æŠ½é¸  
âœ… **è¤‡æ•°æ­£è§£ãƒ‘ã‚¿ãƒ¼ãƒ³** - 1ã¤ã®å•é¡Œã«è¤‡æ•°ã®æ­£è§£ã‚’è¨­å®šå¯èƒ½  
âœ… **æ•°å€¤è¨±å®¹ç¯„å›²** - å°æ•°ç‚¹ã®èª¤å·®ã‚’è€ƒæ…®ã—ãŸåˆ¤å®š  
âœ… **å¤§å°æ–‡å­—è¨­å®š** - ãƒ†ã‚­ã‚¹ãƒˆå›ç­”ã®å¤§å°æ–‡å­—åŒºåˆ¥/ç„¡è¦–  
âœ… **é€²è¡ŒçŠ¶æ…‹ç®¡ç†** - æŒ‘æˆ¦å›æ•°ã€ã‚¯ãƒªã‚¢å›æ•°ã€æœ€çµ‚ãƒ—ãƒ¬ã‚¤æ—¥æ™‚ã‚’è¨˜éŒ²

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

æ—¢å­˜ã®Item/Facilityã‚·ã‚¹ãƒ†ãƒ ã¨åŒã˜**äºŒå±¤æ§‹é€ **ã‚’æ¡ç”¨ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChallengeMasterDatabase (ScriptableObject) â”‚  â† å…¨å•é¡Œã®ç®¡ç†
â”‚ - Resources/ChallengeMasterDatabase.asset  â”‚
â”‚ - 200å•ã‚’ä¸€å…ƒç®¡ç†                          â”‚
â”‚ - çµ±è¨ˆæ©Ÿèƒ½ã€æ¤œç´¢æ©Ÿèƒ½                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ ç®¡ç†
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ChallengeData (ScriptableObject) â”‚  â† å€‹åˆ¥å•é¡Œã®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
â”‚  - å•é¡Œæ–‡ã€æ­£è§£ãƒ‘ã‚¿ãƒ¼ãƒ³          â”‚
â”‚  - å ±é…¬ãƒ†ãƒ¼ãƒ–ãƒ«                 â”‚
â”‚  - é›£æ˜“åº¦ã€ç¨®é¡                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ CreateChallenge()
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Challenge (Serializable)        â”‚  â† ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ï¼ˆå‹•çš„ï¼‰
â”‚  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é€²è¡ŒçŠ¶æ…‹          â”‚
â”‚  - æŒ‘æˆ¦å›æ•°ã€ã‚¯ãƒªã‚¢å›æ•°          â”‚
â”‚  - å›ç­”ãƒã‚§ãƒƒã‚¯å‡¦ç†              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

### ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

#### ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ 

| ãƒ•ã‚¡ã‚¤ãƒ«å | å½¹å‰² | èª¬æ˜ |
|-----------|------|------|
| `ChallengeEnums.cs` | Enumå®šç¾© | é›£æ˜“åº¦ã€ç¨®é¡ã€çŠ¶æ…‹ãªã©ã®åˆ—æŒ™å‹ |
| `RewardSystem.cs` | å ±é…¬ã‚·ã‚¹ãƒ†ãƒ  | ç¢ºç‡ãƒ™ãƒ¼ã‚¹ã®å ±é…¬æŠ½é¸ãƒ­ã‚¸ãƒƒã‚¯ |
| `ChallengeData.cs` | ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ | ScriptableObjectã€å•é¡Œã®å®šç¾© |
| `Challenge.cs` | ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ | ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é€²è¡ŒçŠ¶æ³ã‚’ç®¡ç† |
| `ChallengeMasterDatabase.cs` | **ãƒã‚¹ã‚¿ãƒ¼DB** | **å…¨å•é¡Œãƒ‡ãƒ¼ã‚¿ã®ä¸€å…ƒç®¡ç†** |
| `ChallengeDatabaseHelper.cs` | ãƒ˜ãƒ«ãƒ‘ãƒ¼ | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°é›† |
| `ChallengeDatabaseExample.cs` | ãƒ‡ãƒ¢ | ä½¿ç”¨ä¾‹ã¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ |

#### ã‚¨ãƒ‡ã‚£ã‚¿æ‹¡å¼µ

| ãƒ•ã‚¡ã‚¤ãƒ«å | å½¹å‰² | èª¬æ˜ |
|-----------|------|------|
| `Editor/ChallengeDataEditor.cs` | ã‚«ã‚¹ã‚¿ãƒ Inspector | å•é¡Œä½œæˆã‚’åŠ¹ç‡åŒ– |
| `Editor/ChallengeMasterDatabaseEditor.cs` | ã‚«ã‚¹ã‚¿ãƒ Inspector | MasterDBã®çµ±è¨ˆè¡¨ç¤º |
| `Editor/CSVSimpleParser.cs` | CSVãƒ‘ãƒ¼ã‚µãƒ¼ | RFC 4180æº–æ‹ ã®CSVè§£æ |
| `Editor/ChallengeCSVParser.cs` | CSVå¤‰æ› | CSVè¡Œã‚’ChallengeDataã«å¤‰æ› |
| `Editor/ChallengeCSVImporter.cs` | EditorWindow | CSVä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆUI |

### Enumå®šç¾©

#### ChallengeDifficultyï¼ˆé›£æ˜“åº¦ï¼‰
```csharp
public enum ChallengeDifficulty
{
    Beginner,   // åˆå¿ƒè€…
    Easy,       // ç°¡å˜
    Normal,     // æ™®é€š
    Hard,       // é›£ã—ã„
    Expert      // ä¸Šç´šè€…
}
```

#### ChallengeTypeï¼ˆç¨®é¡ï¼‰
```csharp
public enum ChallengeType
{
    Math,       // æ•°å­¦
    Logic,      // è«–ç†
    Memory,     // è¨˜æ†¶
    Quiz,       // ã‚¯ã‚¤ã‚º
    Other       // ãã®ä»–
}
```

#### AnswerTypeï¼ˆå›ç­”ã‚¿ã‚¤ãƒ—ï¼‰
```csharp
public enum AnswerType
{
    Number,     // æ•°å€¤å…¥åŠ›
    Text        // ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
}
```

#### ChallengeStatusï¼ˆçŠ¶æ…‹ï¼‰
```csharp
public enum ChallengeStatus
{
    Locked,     // ãƒ­ãƒƒã‚¯ä¸­
    Unlocked,   // è§£æ”¾æ¸ˆã¿
    Completed   // ã‚¯ãƒªã‚¢æ¸ˆã¿
}
```

---

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 0. åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæœ€åˆã®1å›ã ã‘ï¼‰

**ChallengeMasterDatabaseã‚¢ã‚»ãƒƒãƒˆã‚’ä½œæˆ:**

1. `Assets/Resources/` ãƒ•ã‚©ãƒ«ãƒ€ã‚’é–‹ãï¼ˆãªã‘ã‚Œã°ä½œæˆï¼‰
2. å³ã‚¯ãƒªãƒƒã‚¯ â†’ `Create > Game > Challenge Master Database`
3. åå‰ã‚’ **`ChallengeMasterDatabase`** ã«å¤‰æ›´ï¼ˆé‡è¦ï¼ï¼‰
4. å®Œäº†ï¼ã“ã‚Œã§å•é¡Œç®¡ç†ã®æº–å‚™å®Œäº†

> ğŸ’¡ ã“ã®ã‚¢ã‚»ãƒƒãƒˆã¯**1ã¤ã ã‘**ä½œæˆã—ã¦ãã ã•ã„ã€‚å…¨ã¦ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒã“ã“ã«ç™»éŒ²ã•ã‚Œã¾ã™ã€‚

### 1. å•é¡Œãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

1. Projectã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§å³ã‚¯ãƒªãƒƒã‚¯
2. `Create > Game > Challenge Data` ã‚’é¸æŠ
3. å•é¡Œãƒ‡ãƒ¼ã‚¿ã«åå‰ã‚’ã¤ã‘ã‚‹ï¼ˆä¾‹: `Challenge_Math_001`ï¼‰

### 2. å•é¡Œãƒ‡ãƒ¼ã‚¿ã®è¨­å®š

Inspectorã§ä»¥ä¸‹ã‚’è¨­å®šï¼š

```
ã€åŸºæœ¬æƒ…å ±ã€‘
- Challenge Id: "challenge_math_001"
- Challenge Name: "ç°¡å˜ãªè¶³ã—ç®—"
- Description: "2ã¤ã®æ•°å­—ã‚’è¶³ã—ãŸç­”ãˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
- Difficulty: Easy
- Type: Math

ã€å•é¡Œå†…å®¹ã€‘
- Question Text: "3 + 5 = ?"
- Answer Type: Number
- Correct Answers: ["8"]
- Numeric Tolerance: 0

ã€å ±é…¬è¨­å®šã€‘
- Guaranteed Money: 100
- Reward Items:
  - Item Id: "item_wood"
  - Min Quantity: 1
  - Max Quantity: 3
  - Drop Rate: 0.5
```

### 3. ChallengeMasterDatabaseã«ç™»éŒ²

å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ãŸã‚‰ã€MasterDatabaseã«ç™»éŒ²ã—ã¾ã™ï¼š

1. ä½œæˆã—ãŸå•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’é¸æŠ
2. Inspectorä¸‹éƒ¨ã«ã‚ã‚‹ **ã€ŒMasterDBã«è¿½åŠ ã€** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. Console ã«ã€Œå•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã¾ã—ãŸã€ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°OKï¼

### 4. ç™»éŒ²ç¢ºèª

1. `Assets/Resources/ChallengeMasterDatabase` ã‚¢ã‚»ãƒƒãƒˆã‚’é¸æŠ
2. Inspectorã§ç™»éŒ²ã—ãŸå•é¡ŒãŒè¡¨ç¤ºã•ã‚Œã¾ã™
3. **ã€Œçµ±è¨ˆã‚’è¡¨ç¤ºã€** ãƒœã‚¿ãƒ³ã§å•é¡Œæ•°ã‚’ç¢ºèªã§ãã¾ã™

### 5. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

1. ã‚·ãƒ¼ãƒ³ã«ç©ºã®GameObjectã‚’ä½œæˆ
2. `ChallengeDatabaseExample` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¢ã‚¿ãƒƒãƒ
3. `Test Challenges` ãƒªã‚¹ãƒˆã«ä½œæˆã—ãŸå•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
4. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å³ã‚¯ãƒªãƒƒã‚¯ â†’ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```
1. ãƒ©ãƒ³ãƒ€ãƒ ã«å•é¡Œã‚’é¸æŠ
2. å›ç­”ã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆTest Answerã«å›ç­”ã‚’å…¥åŠ›ï¼‰
3. å ±é…¬æŠ½é¸ãƒ†ã‚¹ãƒˆ
4. çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤º
```

---

## è©³ç´°ã‚¬ã‚¤ãƒ‰

### å…¥åŠ›å¼å•é¡Œã®è¨­è¨ˆ

#### æ•°å€¤å•é¡Œã®ä¾‹

```
å•é¡Œ: "å††å‘¨ç‡ã®å€¤ã¯ï¼Ÿï¼ˆå°æ•°ç¬¬2ä½ã¾ã§ï¼‰"
Answer Type: Number
Correct Answers: ["3.14"]
Numeric Tolerance: 0.01  // Â±0.01ã®èª¤å·®ã‚’è¨±å®¹
```

ã“ã®è¨­å®šã§ã¯ã€`3.13`ï½`3.15`ã®ç¯„å›²ãŒæ­£è§£ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚

#### ãƒ†ã‚­ã‚¹ãƒˆå•é¡Œã®ä¾‹

```
å•é¡Œ: "æ—¥æœ¬ã®é¦–éƒ½ã¯ã©ã“ã§ã™ã‹ï¼Ÿ"
Answer Type: Text
Correct Answers: ["æ±äº¬", "Tokyo", "ã¨ã†ãã‚‡ã†"]
Case Sensitive: false  // å¤§å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„
```

è¤‡æ•°ã®æ­£è§£ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€æŸ”è»Ÿãªåˆ¤å®šãŒå¯èƒ½ã§ã™ã€‚

### å ±é…¬ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆ

#### å›ºå®šå ±é…¬

```csharp
Guaranteed Money: 100  // å¿…ãš100å††ç²å¾—
```

#### ç¢ºç‡å ±é…¬

```csharp
Reward Items:
  - Item: "rare_item"
    Min Quantity: 1
    Max Quantity: 1
    Drop Rate: 0.1  // 10%ã®ç¢ºç‡ã§ãƒ‰ãƒ­ãƒƒãƒ—
    
  - Item: "common_item"
    Min Quantity: 3
    Max Quantity: 5
    Drop Rate: 0.7  // 70%ã®ç¢ºç‡ã§3ï½5å€‹ãƒ‰ãƒ­ãƒƒãƒ—
```

**ãƒ‰ãƒ­ãƒƒãƒ—ç‡ã®åˆè¨ˆãŒ1.0ã‚’è¶…ãˆã¦ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“**ã€‚å„ã‚¢ã‚¤ãƒ†ãƒ ã¯ç‹¬ç«‹ã—ã¦æŠ½é¸ã•ã‚Œã¾ã™ã€‚

### ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã®ä½¿ã„æ–¹

#### ãƒ©ãƒ³ãƒ€ãƒ ã«å•é¡Œã‚’é¸æŠ

```csharp
List<ChallengeData> allChallenges = /* ... */;
ChallengeDifficulty difficulty = ChallengeDifficulty.Normal;

ChallengeData randomChallenge = ChallengeDatabaseHelper.GetRandomChallengeByDifficulty(
    allChallenges, 
    difficulty
);

if (randomChallenge != null)
{
    Challenge challenge = randomChallenge.CreateChallenge();
    challenge.Unlock();
    // å•é¡Œã‚’è¡¨ç¤º...
}
```

#### å›ç­”ãƒã‚§ãƒƒã‚¯

```csharp
Challenge currentChallenge = /* ... */;
string userInput = "ç­”ãˆ";

currentChallenge.IncrementAttempt();
bool isCorrect = currentChallenge.CheckAnswer(userInput);

if (isCorrect)
{
    currentChallenge.RecordCompletion();
    // å ±é…¬ã‚’ä»˜ä¸...
}
```

#### å ±é…¬ä»˜ä¸

```csharp
ChallengeData challengeData = /* ... */;

ChallengeDatabaseHelper.GiveRewards(
    challengeData.rewardTable,
    onItemReward: (itemId, quantity) =>
    {
        // GameDatabase.Instance.AddItem(itemId, ...);
        Debug.Log($"ã‚¢ã‚¤ãƒ†ãƒ  {itemId} x {quantity} ç²å¾—ï¼");
    },
    onMoneyReward: (amount) =>
    {
        // GameDatabase.Instance.AddMoney(amount);
        Debug.Log($"ãŠé‡‘ {amount} ç²å¾—ï¼");
    }
);
```

#### çµ±è¨ˆæƒ…å ±ã®å–å¾—

```csharp
List<Challenge> playerChallenges = /* ... */;

// å…¨ä½“çµ±è¨ˆ
string stats = ChallengeDatabaseHelper.GetStatistics(playerChallenges);
Debug.Log(stats);

// ã‚¯ãƒªã‚¢æ¸ˆã¿æ•°
int completedCount = ChallengeDatabaseHelper.GetCompletedChallengeCount(playerChallenges);

// é›£æ˜“åº¦åˆ¥ã‚¯ãƒªã‚¢æ•°
int hardCompleted = ChallengeDatabaseHelper.GetCompletedChallengeCountByDifficulty(
    playerChallenges, 
    ChallengeDifficulty.Hard
);
```

### ChallengeMasterDatabaseã®ä½¿ã„æ–¹

#### ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã‚¢ã‚¯ã‚»ã‚¹

```csharp
// ã©ã“ã‹ã‚‰ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ï¼ˆGameObjectã«ã‚¢ã‚¿ãƒƒãƒä¸è¦ï¼‰
ChallengeMasterDatabase masterDB = ChallengeMasterDatabase.Instance;
```

#### å•é¡Œãƒ‡ãƒ¼ã‚¿ã®å–å¾—

```csharp
// ã™ã¹ã¦ã®å•é¡Œã‚’å–å¾—
List<ChallengeData> allChallenges = ChallengeMasterDatabase.Instance.GetAllChallengeData();

// IDã§å•é¡Œã‚’æ¤œç´¢
ChallengeData challenge = ChallengeMasterDatabase.Instance.GetChallengeData("challenge_math_001");

// é›£æ˜“åº¦åˆ¥ã«å–å¾—
List<ChallengeData> easyChallenges = ChallengeMasterDatabase.Instance.GetChallengeDataByDifficulty(
    ChallengeDifficulty.Easy
);

// ãƒ©ãƒ³ãƒ€ãƒ ã«å•é¡Œã‚’é¸æŠ
ChallengeData randomChallenge = ChallengeMasterDatabase.Instance.GetRandomChallengeByDifficulty(
    ChallengeDifficulty.Normal
);
```

#### çµ±è¨ˆæƒ…å ±ã®å–å¾—

```csharp
// ç·å•é¡Œæ•°
int totalCount = ChallengeMasterDatabase.Instance.GetChallengeCount();
Debug.Log($"ç™»éŒ²æ¸ˆã¿å•é¡Œæ•°: {totalCount}");

// é›£æ˜“åº¦åˆ¥ã®å•é¡Œæ•°
int normalCount = ChallengeMasterDatabase.Instance.GetChallengeCountByDifficulty(
    ChallengeDifficulty.Normal
);

// çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤º
string stats = ChallengeMasterDatabase.Instance.GetStatistics();
Debug.Log(stats);
```

#### ã‚¨ãƒ‡ã‚£ã‚¿æ©Ÿèƒ½

ChallengeMasterDatabaseã‚¢ã‚»ãƒƒãƒˆã‚’é¸æŠã™ã‚‹ã¨ã€Inspector ã«ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

- **çµ±è¨ˆã‚’è¡¨ç¤º** ãƒœã‚¿ãƒ³ - å…¨å•é¡Œã®çµ±è¨ˆã‚’ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§è¡¨ç¤º
- **ã‚¯ã‚¤ãƒƒã‚¯æƒ…å ±** - é›£æ˜“åº¦åˆ¥ãƒ»ç¨®é¡åˆ¥ã®å•é¡Œæ•°ã‚’ä¸€ç›®ã§ç¢ºèª
- **ã™ã¹ã¦å‰Šé™¤** ãƒœã‚¿ãƒ³ - å…¨å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ï¼ˆè¦ç¢ºèªï¼‰
- **ä¿å­˜** ãƒœã‚¿ãƒ³ - å¤‰æ›´ã‚’ä¿å­˜

### ã‚«ã‚¹ã‚¿ãƒ Inspectorã®æ©Ÿèƒ½

#### ChallengeDataEditorï¼ˆå•é¡Œä½œæˆç”¨ï¼‰

å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’é¸æŠã™ã‚‹ã¨ã€Inspector ã«ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

1. **IDè‡ªå‹•ç”Ÿæˆ** - `challenge_[ç¨®é¡]_[é›£æ˜“åº¦]_[é€£ç•ª]` å½¢å¼ã§è‡ªå‹•ç”Ÿæˆ
2. **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³** - ãƒ‡ãƒ¼ã‚¿ã®å¦¥å½“æ€§ã‚’ãƒã‚§ãƒƒã‚¯
3. **è¤‡è£½ã—ã¦æ–°è¦ä½œæˆ** - ä¼¼ãŸå•é¡Œã‚’ä½œã‚‹éš›ã«ä¾¿åˆ©
4. **MasterDBã«è¿½åŠ ** - ChallengeMasterDatabaseã«ç™»éŒ²

**æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³:**
- **å•é¡Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼** - å•é¡Œæ–‡ã€æ­£è§£ã€è¨­å®šã‚’è¦‹ã‚„ã™ãè¡¨ç¤º
- **å ±é…¬æƒ…å ±** - ãƒ‰ãƒ­ãƒƒãƒ—ç‡ã®åˆè¨ˆã¨æœŸå¾…å€¤ã‚’è‡ªå‹•è¨ˆç®—

---

## CSVä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

å¤§é‡ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ï¼ˆ200å•ãªã©ï¼‰ã‚’åŠ¹ç‡çš„ã«ä½œæˆã™ã‚‹ãŸã‚ã®CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã¾ã™

### CSVãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™

#### CSVå½¢å¼ä»•æ§˜

**åˆ—å®šç¾©ï¼ˆ10åˆ—ï¼‰:**
```csv
challengeId,challengeName,description,difficulty,type,questionText,answerType,correctAnswers,hint,rewardItems
```

#### ç‰¹æ®Šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¨˜æ³•

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å½¢å¼ | ä¾‹ |
|----------|------|-----|
| `correctAnswers` | ãƒ‘ã‚¤ãƒ—åŒºåˆ‡ã‚Š | `42\|42.0\|å››åäºŒ` |
| `rewardItems` | **JSONé…åˆ—** | `[{"itemId":"gold","minQuantity":10,"maxQuantity":20,"dropRate":0.8}]` |
| `difficulty` | Enumæ–‡å­—åˆ— | `Beginner`, `Easy`, `Normal`, `Hard`, `Expert` |
| `type` | Enumæ–‡å­—åˆ— | `Math`, `Logic`, `Memory`, `Quiz`, `Other` |
| `answerType` | Enumæ–‡å­—åˆ— | `Number`, `Text` |

#### RewardItemsï¼ˆJSONé…åˆ—ï¼‰ã®è¨˜æ³•

ç©ºã®å ´åˆ:
```csv
[]
```

1ã¤ã®å ±é…¬:
```csv
"[{""itemId"":""gold_coin"",""minQuantity"":10,""maxQuantity"":20,""dropRate"":0.8}]"
```

è¤‡æ•°ã®å ±é…¬:
```csv
"[{""itemId"":""gold_coin"",""minQuantity"":10,""maxQuantity"":20,""dropRate"":0.8},{""itemId"":""rare_gem"",""minQuantity"":1,""maxQuantity"":1,""dropRate"":0.1}]"
```

**æ³¨æ„ç‚¹:**
- CSVå†…ã®JSONæ–‡å­—åˆ—å…¨ä½“ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆ `"` ã§å›²ã‚€
- JSONå†…éƒ¨ã®ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã¯ `""` ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆ2ã¤é‡ã­ã‚‹ï¼‰
- Excelã§CSVã‚’ç·¨é›†ã™ã‚‹å ´åˆã€è‡ªå‹•çš„ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã¾ã™

#### ã‚µãƒ³ãƒ—ãƒ«CSV

[Assets/Editor/CSV/challenge_sample.csv](../../../Editor/CSV/challenge_sample.csv) ã«10å•åˆ†ã®ã‚µãƒ³ãƒ—ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

**ã‚µãƒ³ãƒ—ãƒ«è¡Œï¼ˆè¦‹ã‚„ã™ãæ•´å½¢ï¼‰:**
```csv
challengeId: challenge_math_easy_001
challengeName: ç°¡å˜ãªè¶³ã—ç®—
description: åŸºæœ¬çš„ãªè¶³ã—ç®—å•é¡Œã§ã™
difficulty: Easy
type: Math
questionText: 1 + 1 ã¯?
answerType: Number
correctAnswers: 2
hint: æŒ‡ã‚’ä½¿ã£ã¦æ•°ãˆã¦ã¿ã‚ˆã†
rewardItems: "[{""itemId"":""gold_coin"",""minQuantity"":5,""maxQuantity"":10,""dropRate"":0.8}]"
```

### ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ‰‹é †

#### 1. CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«é…ç½®

1. CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆExcelã‚„ä»»æ„ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã§ï¼‰
2. `Assets/Editor/CSV/` ãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®ï¼ˆãƒ•ã‚©ãƒ«ãƒ€ãŒãªã‘ã‚Œã°ä½œæˆï¼‰
3. Unity ã‚¨ãƒ‡ã‚£ã‚¿ã§èªè­˜ã•ã‚Œã‚‹ã¾ã§å¾…ã¤

#### 2. CSV Importerã‚’é–‹ã

1. Unity ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‹ã‚‰ `Tools > Challenge DB > CSV Importer` ã‚’é¸æŠ
2. CSV Importer ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã¾ã™

#### 3. CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ

1. **CSVãƒ•ã‚¡ã‚¤ãƒ«** æ¬„ã«ã€ä½œæˆã—ãŸTextAssetã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—
   - ã¾ãŸã¯ã€â—ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ `challenge_sample.csv` ãªã©ã‚’é¸æŠ
2. **å‡ºåŠ›å…ˆ** ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® `Assets/GameData/Challenges/` ã®ã¾ã¾ã§OK

#### 4. ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ

1. **ã€Œã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œã€** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½ï¼‰
3. å®Œäº†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰æˆåŠŸã§ã™

```
ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Œäº†
æˆåŠŸ: 10ä»¶ / 10ä»¶
æ‰€è¦æ™‚é–“: 2.35ç§’

[OK]
```

#### 5. ç¢ºèª

1. `Assets/GameData/Challenges/` ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç¢ºèª
   - `Math/Easy/challenge_math_easy_001.asset` ã®ã‚ˆã†ã«éšå±¤åŒ–ã•ã‚Œã¦ä¿å­˜
2. `Assets/Resources/ChallengeMasterDatabase` ã‚’é¸æŠ
   - Inspectorã§ã€Œçµ±è¨ˆã‚’è¡¨ç¤ºã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   - ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸå•é¡Œæ•°ãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### ã‚¨ãƒ©ãƒ¼æ™‚ã®å‹•ä½œ

**å³åº§ã«ä¸­æ–­æ–¹å¼**ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ï¼š
- ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸè¡Œã§å³åº§ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆåœæ­¢
- è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
- ã‚¨ãƒ©ãƒ¼ä¿®æ­£å¾Œã€å†åº¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ

#### å…¸å‹çš„ãªã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•

**1. CSVæ§‹æ–‡ã‚¨ãƒ©ãƒ¼**
```
CSVæ§‹æ–‡ã‚¨ãƒ©ãƒ¼
Line 5: Column count mismatch. Expected 15, got 14
```
â†’ **å¯¾å‡¦**: è©²å½“è¡Œã®åˆ—æ•°ã‚’ç¢ºèªã€‚ã‚«ãƒ³ãƒã®æ•°ã€ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã®é–‰ã˜å¿˜ã‚Œã‚’ãƒã‚§ãƒƒã‚¯

**2. å¿…é ˆé …ç›®æ¬ å¦‚**
```
Row 3: challenge_math_003

ã‚¨ãƒ©ãƒ¼å†…å®¹:
- questionTextãŒç©ºã§ã™
- correctAnswersãŒç©ºã§ã™
```
â†’ **å¯¾å‡¦**: å¿…é ˆé …ç›®ï¼ˆchallengeId, challengeName, questionText, correctAnswersï¼‰ã‚’å…¥åŠ›

**3. Enumå€¤ä¸æ­£**
```
Row 7: challenge_quiz_001

ã‚¨ãƒ©ãƒ¼å†…å®¹:
- ä¸æ­£ãªdifficultyå€¤: Mediam
```
â†’ **å¯¾å‡¦**: Enumå€¤ã®ã‚¹ãƒšãƒ«ãƒŸã‚¹ã‚’ä¿®æ­£ï¼ˆ`Mediam` â†’ `Medium` â€»ãŸã ã—æ­£ã—ãã¯ `Normal`ï¼‰

**4. JSONè§£æã‚¨ãƒ©ãƒ¼**
```
Row 10: challenge_logic_001

ã‚¨ãƒ©ãƒ¼å†…å®¹:
- rewardItemsã®JSONè§£æã‚¨ãƒ©ãƒ¼: Invalid JSON
```
â†’ **å¯¾å‡¦**: JSONæ§‹æ–‡ã‚’ç¢ºèªã€‚ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ˆ`""`ï¼‰ã€ã‚«ãƒ³ãƒã€æ‹¬å¼§ã®å¯¾å¿œã‚’ãƒã‚§ãƒƒã‚¯

#### ãƒ‡ãƒãƒƒã‚°ã®ã‚³ãƒ„

1. **å°è¦æ¨¡ãƒ†ã‚¹ãƒˆ**: ã¾ãšã‚µãƒ³ãƒ—ãƒ«CSVã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆæˆåŠŸã‚’ç¢ºèª
2. **æ®µéšçš„è¿½åŠ **: 10å•ãšã¤ãªã©ã€å°åˆ†ã‘ã«ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
3. **Excelæ´»ç”¨**: Excelã§ç·¨é›†ã™ã‚‹ã¨ã€ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã®ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ãŒè‡ªå‹•åŒ–ã•ã‚Œã¦ä¾¿åˆ©
4. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: å¤§é‡ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‰ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

| å•é¡Œæ•° | æ‰€è¦æ™‚é–“ï¼ˆç›®å®‰ï¼‰ | ãƒ¡ãƒ¢ãƒª |
|-------|---------------|--------|
| 10å• | 1-3ç§’ | ä½ |
| 50å• | 5-10ç§’ | ä½ |
| 100å• | 10-20ç§’ | ä¸­ |
| 200å• | 20-40ç§’ | ä¸­ |
| 500å• | 50-100ç§’ | é«˜ |

**æœ€é©åŒ–ãƒã‚¤ãƒ³ãƒˆ:**
- 100å•ã”ã¨ã«è‡ªå‹•ä¿å­˜ï¼ˆ`AssetDatabase.SaveAssets()`ï¼‰
- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½

### ã‚ˆãã‚ã‚‹è³ªå•

**Q: æ—¢å­˜ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãã—ãŸããªã„**  
A: åŒã˜ `challengeId` ã®ã‚¢ã‚»ãƒƒãƒˆãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã€Œã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€ã‚’é¸æŠã™ã‚Œã°ã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸­æ–­ã•ã‚Œã¾ã™ã€‚

**Q: CSVãƒ•ã‚¡ã‚¤ãƒ«ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã¯ï¼Ÿ**  
A: UTF-8æ¨å¥¨ã€‚BOMä»˜ãUTF-8ã‚‚è‡ªå‹•èªè­˜ã•ã‚Œã¾ã™ã€‚Shift_JISãªã©ã¯æ–‡å­—åŒ–ã‘ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**Q: rewardItemsã‚’ç©ºã«ã—ãŸã„**  
A: `[]` ã¾ãŸã¯ç©ºæ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚

**Q: correctAnswersã«æ”¹è¡Œã‚’å«ã‚ãŸã„**  
A: CSVã®åˆ¶ç´„ä¸Šã€æ”¹è¡Œã¯æ‰±ãˆã¾ã›ã‚“ã€‚ä»£æ›¿æ¡ˆã¨ã—ã¦ `\n` ã‚’å«ã‚€æ–‡å­—åˆ—ã‚’è¨­å®šã—ã€ã‚²ãƒ¼ãƒ å´ã§ç½®æ›ã—ã¦ãã ã•ã„ã€‚

**Q: å¤§é‡ã®å•é¡Œã‚’ä¸€åº¦ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã‚‚å¤§ä¸ˆå¤«ï¼Ÿ**  
A: 500å•ç¨‹åº¦ã¾ã§ã¯å•é¡Œã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®ãƒ‡ãƒãƒƒã‚°ã‚’è€ƒæ…®ã—ã€100å•ãšã¤ãªã©åˆ†å‰²ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’æ¨å¥¨ã—ã¾ã™ã€‚

---

## GameDatabaseçµ±åˆï¼ˆå°†æ¥ã®æ‹¡å¼µç”¨ï¼‰

ç¾åœ¨ã€ChallengeMasterDatabaseã¯ç‹¬ç«‹ã—ã¦å‹•ä½œã—ã¾ã™ã€‚å°†æ¥çš„ã«GameDatabaseã¨çµ±åˆã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

### MasterDatabaseã¸ã®çµ±åˆ

`MasterDatabase.cs` ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```csharp
[Header("å•é¡Œãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿")]
[SerializeField] private List<ChallengeData> allChallenges = new List<ChallengeData>();

/// <summary>
/// ã™ã¹ã¦ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
/// </summary>
public List<ChallengeData> GetAllChallengeData()
{
    return new List<ChallengeData>(allChallenges);
}

/// <summary>
/// IDã§å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
/// </summary>
public ChallengeData GetChallengeData(string challengeId)
{
    return allChallenges.Find(c => c.challengeId == challengeId);
}

/// <summary>
/// é›£æ˜“åº¦åˆ¥ã«ãƒ©ãƒ³ãƒ€ãƒ ã§å•é¡Œã‚’å–å¾—
/// </summary>
public ChallengeData GetRandomChallengeByDifficulty(ChallengeDifficulty difficulty)
{
    return ChallengeDatabaseHelper.GetRandomChallengeByDifficulty(allChallenges, difficulty);
}

/// <summary>
/// å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ç”¨ï¼‰
/// </summary>
public void AddChallengeData(ChallengeData challengeData)
{
    if (!allChallenges.Contains(challengeData))
    {
        allChallenges.Add(challengeData);
#if UNITY_EDITOR
        UnityEditor.EditorUtility.SetDirty(this);
#endif
    }
}
```

### GameDatabaseã¸ã®çµ±åˆ

`GameDatabase.cs` ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```csharp
[Header("å•é¡Œãƒ‡ãƒ¼ã‚¿")]
[SerializeField] private List<Challenge> challenges = new List<Challenge>();

/// <summary>
/// ã™ã¹ã¦ã®å•é¡Œã‚’å–å¾—
/// </summary>
public List<Challenge> GetAllChallenges()
{
    return new List<Challenge>(challenges);
}

/// <summary>
/// å•é¡Œã‚’è¿½åŠ 
/// </summary>
public void AddChallenge(Challenge challenge)
{
    Challenge existing = ChallengeDatabaseHelper.FindChallengeById(challenges, challenge.challengeId);
    if (existing == null)
    {
        challenges.Add(challenge);
        Debug.Log($"å•é¡Œã€Œ{challenge.challengeName}ã€ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚");
    }
}

/// <summary>
/// å•é¡Œã‚’è§£æ”¾
/// </summary>
public bool UnlockChallenge(string challengeId)
{
    Challenge challenge = ChallengeDatabaseHelper.FindChallengeById(challenges, challengeId);
    if (challenge != null)
    {
        challenge.Unlock();
        return true;
    }
    
    // MasterDatabaseã‹ã‚‰ä½œæˆ
    ChallengeData challengeData = MasterDatabase.Instance.GetChallengeData(challengeId);
    if (challengeData != null)
    {
        Challenge newChallenge = challengeData.CreateChallenge();
        newChallenge.Unlock();
        AddChallenge(newChallenge);
        return true;
    }
    
    Debug.LogWarning($"å•é¡Œã€Œ{challengeId}ã€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚");
    return false;
}

/// <summary>
/// å›ç­”ã‚’é€ä¿¡ã—ã¦ã‚¯ãƒªã‚¢åˆ¤å®š
/// </summary>
public bool SubmitChallengeAnswer(string challengeId, string userAnswer)
{
    Challenge challenge = ChallengeDatabaseHelper.FindChallengeById(challenges, challengeId);
    if (challenge == null || challenge.status != ChallengeStatus.Unlocked)
    {
        return false;
    }
    
    challenge.IncrementAttempt();
    bool isCorrect = challenge.CheckAnswer(userAnswer);
    
    if (isCorrect)
    {
        challenge.RecordCompletion();
        
        // å ±é…¬ä»˜ä¸
        ChallengeData challengeData = MasterDatabase.Instance.GetChallengeData(challengeId);
        if (challengeData != null)
        {
            ChallengeDatabaseHelper.GiveRewards(
                challengeData.rewardTable,
                onItemReward: (itemId, quantity) =>
                {
                    ItemData itemData = MasterDatabase.Instance.GetItemData(itemId);
                    if (itemData != null)
                    {
                        AddItem(itemData.itemId, itemData.itemName, itemData.description,
                               quantity, itemData.type);
                    }
                },
                onMoneyReward: (amount) =>
                {
                    AddMoney(amount);
                }
            );
        }
    }
    
    return isCorrect;
}

/// <summary>
/// ã‚¯ãƒªã‚¢æ¸ˆã¿å•é¡Œæ•°ã‚’å–å¾—
/// </summary>
public int GetCompletedChallengeCount()
{
    return ChallengeDatabaseHelper.GetCompletedChallengeCount(challenges);
}
```

### çµ±åˆå¾Œã®ä½¿ç”¨ä¾‹

```csharp
// é›£æ˜“åº¦ã‚’é¸æŠã—ã¦ãƒ©ãƒ³ãƒ€ãƒ ã«å•é¡Œã‚’å–å¾—
ChallengeData challengeData = MasterDatabase.Instance.GetRandomChallengeByDifficulty(
    ChallengeDifficulty.Normal
);

// GameDatabaseã«è¿½åŠ ã—ã¦è§£æ”¾
GameDatabase.Instance.UnlockChallenge(challengeData.challengeId);

// å›ç­”ã‚’é€ä¿¡
bool isCorrect = GameDatabase.Instance.SubmitChallengeAnswer(
    challengeData.challengeId, 
    userInputField.text
);

if (isCorrect)
{
    Debug.Log("æ­£è§£ï¼å ±é…¬ã‚’ç²å¾—ã—ã¾ã—ãŸï¼");
}
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q. å•é¡ŒãŒé¸æŠã•ã‚Œãªã„

**A.** ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
- `testChallenges` ãƒªã‚¹ãƒˆã«å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹
- æŒ‡å®šã—ãŸé›£æ˜“åº¦ã®å•é¡ŒãŒå­˜åœ¨ã™ã‚‹ã‹
- å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒnullã§ã¯ãªã„ã‹

### Q. æ­£è§£ãªã®ã«ä¸æ­£è§£ã«ãªã‚‹

**A.** ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
- `Correct Answers` ã«æ­£ã—ã„å€¤ãŒå…¥ã£ã¦ã„ã‚‹ã‹
- **æ•°å€¤å•é¡Œ**: `Numeric Tolerance` ã®è¨­å®šãŒé©åˆ‡ã‹
- **ãƒ†ã‚­ã‚¹ãƒˆå•é¡Œ**: `Case Sensitive` ã®è¨­å®šãŒé©åˆ‡ã‹
- ç©ºç™½æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ãªã„ã‹ï¼ˆè‡ªå‹•ã§Trimã•ã‚Œã¾ã™ï¼‰

### Q. å ±é…¬ãŒãƒ‰ãƒ­ãƒƒãƒ—ã—ãªã„

**A.** ã“ã‚Œã¯æ­£å¸¸ãªå‹•ä½œã§ã™ã€‚`Drop Rate` ãŒ1.0æœªæº€ã®å ´åˆã€ç¢ºç‡ã§æŠ½é¸ã•ã‚Œã¾ã™ã€‚ä½•åº¦ã‹è©¦ã—ã¦ãã ã•ã„ã€‚ãƒ†ã‚¹ãƒˆæ™‚ã¯ `Drop Rate` ã‚’1.0ã«è¨­å®šã™ã‚‹ã¨ç¢ºå®Ÿã«ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¾ã™ã€‚

### Q. MasterDatabaseã«çµ±åˆã§ããªã„

**A.** ç¾åœ¨ã€ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ç‹¬ç«‹ã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å‹•ä½œã—ã¾ã™ã€‚çµ±åˆã¯ä¸Šè¨˜ã®æ‰‹é †ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚å…±åŒä½œæ¥­è€…ã¨èª¿æ•´ã®ä¸Šã€æ…é‡ã«çµ±åˆã—ã¦ãã ã•ã„ã€‚

### Q. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹

**A.** ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ `Assets/Scripts/ChallengeDB/` ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€Unity 2021.3ä»¥é™ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

---

## API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### ChallengeDataï¼ˆScriptableObjectï¼‰

| ãƒ¡ãƒ³ãƒãƒ¼ | å‹ | èª¬æ˜ |
|---------|---|------|
| `challengeId` | `string` | å•é¡Œã®ä¸€æ„ãªID |
| `challengeName` | `string` | å•é¡Œã®è¡¨ç¤ºå |
| `difficulty` | `ChallengeDifficulty` | é›£æ˜“åº¦ |
| `questionText` | `string` | å•é¡Œæ–‡ |
| `correctAnswers` | `string[]` | æ­£è§£ãƒ‘ã‚¿ãƒ¼ãƒ³ |
| `rewardTable` | `RewardTable` | å ±é…¬ãƒ†ãƒ¼ãƒ–ãƒ« |
| `CreateChallenge()` | `Challenge` | ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆ |
| `Validate(out string)` | `bool` | ãƒ‡ãƒ¼ã‚¿å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯ |

### Challengeï¼ˆSerializableï¼‰

| ãƒ¡ãƒ³ãƒãƒ¼ | å‹ | èª¬æ˜ |
|---------|---|------|
| `status` | `ChallengeStatus` | ç¾åœ¨ã®çŠ¶æ…‹ |
| `attemptCount` | `int` | æŒ‘æˆ¦å›æ•° |
| `completedCount` | `int` | ã‚¯ãƒªã‚¢å›æ•° |
| `CheckAnswer(string)` | `bool` | å›ç­”ãƒã‚§ãƒƒã‚¯ |
| `IncrementAttempt()` | `void` | æŒ‘æˆ¦å›æ•°ã‚’å¢—ã‚„ã™ |
| `RecordCompletion()` | `void` | ã‚¯ãƒªã‚¢è¨˜éŒ² |
| `Unlock()` | `void` | å•é¡Œã‚’è§£æ”¾ |

### ChallengeMasterDatabaseï¼ˆScriptableObject - ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰

| ãƒ¡ãƒ³ãƒãƒ¼ | å‹ | èª¬æ˜ |
|---------|---|------|
| `Instance` | `static ChallengeMasterDatabase` | ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆResources.Loadï¼‰ |
| `GetAllChallengeData()` | `List<ChallengeData>` | ã™ã¹ã¦ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å–å¾— |
| `GetChallengeData(string)` | `ChallengeData` | IDã§å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å–å¾— |
| `GetChallengeDataByDifficulty()` | `List<ChallengeData>` | é›£æ˜“åº¦åˆ¥ã«å•é¡Œã‚’å–å¾— |
| `GetRandomChallengeByDifficulty()` | `ChallengeData` | é›£æ˜“åº¦åˆ¥ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ |
| `AddChallengeData()` | `void` | å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ç”¨ï¼‰ |
| `RemoveChallengeData()` | `bool` | å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ç”¨ï¼‰ |
| `GetChallengeCount()` | `int` | ç·å•é¡Œæ•°ã‚’å–å¾— |
| `GetChallengeCountByDifficulty()` | `int` | é›£æ˜“åº¦åˆ¥ã®å•é¡Œæ•°ã‚’å–å¾— |
| `GetStatistics()` | `string` | çµ±è¨ˆæƒ…å ±ã‚’æ–‡å­—åˆ—ã§å–å¾— |

**ä½¿ç”¨ä¾‹:**
```csharp
// ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³çµŒç”±ã§ã‚¢ã‚¯ã‚»ã‚¹
ChallengeMasterDatabase.Instance.GetRandomChallengeByDifficulty(ChallengeDifficulty.Normal);
```

### ChallengeDatabaseHelperï¼ˆé™çš„ï¼‰

| ãƒ¡ã‚½ãƒƒãƒ‰ | èª¬æ˜ |
|---------|------|
| `GetRandomChallengeByDifficulty()` | é›£æ˜“åº¦åˆ¥ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ |
| `FilterByDifficulty()` | é›£æ˜“åº¦ã§ãƒ•ã‚£ãƒ«ã‚¿ |
| `GiveRewards()` | å ±é…¬ä»˜ä¸ |
| `GetCompletedChallengeCount()` | ã‚¯ãƒªã‚¢æ•°å–å¾— |
| `GetStatistics()` | çµ±è¨ˆæƒ…å ±å–å¾— |

---

## æ›´æ–°å±¥æ­´

### v1.1.0 (2026/02/19)
- **CSVä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½è¿½åŠ **
  - CSVSimpleParser: RFC 4180æº–æ‹ ã®CSVãƒ‘ãƒ¼ã‚µãƒ¼
  - ChallengeCSVParser: CSVè¡Œã‹ã‚‰ChallengeDataç”Ÿæˆ
  - ChallengeCSVImporter: EditorWindowã«ã‚ˆã‚‹ä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆUI
  - JSONå½¢å¼ã§ã®RewardItemsè¨˜è¿°å¯¾å¿œ
  - ã‚¨ãƒ©ãƒ¼æ™‚å³åº§ä¸­æ–­æ–¹å¼ã®æ¡ç”¨
  - ã‚µãƒ³ãƒ—ãƒ«CSVãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ10å•ï¼‰ã‚’æ·»ä»˜
  - è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½
- READMEæ›´æ–°: CSVå½¢å¼ä»•æ§˜ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ‰‹é †ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¿½åŠ 

### v1.0.0 (2026/02/15)
- åˆå›ãƒªãƒªãƒ¼ã‚¹
- å…¥åŠ›å¼å•é¡Œã‚·ã‚¹ãƒ†ãƒ ã®åŸºæœ¬å®Ÿè£…
- 5æ®µéšé›£æ˜“åº¦ã‚·ã‚¹ãƒ†ãƒ 
- ç¢ºç‡ãƒ™ãƒ¼ã‚¹å ±é…¬ã‚·ã‚¹ãƒ†ãƒ 
- ãƒ©ãƒ³ãƒ€ãƒ å‡ºé¡Œæ©Ÿèƒ½
- è¤‡æ•°æ­£è§£ãƒ‘ã‚¿ãƒ¼ãƒ³å¯¾å¿œ

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»é€£çµ¡å…ˆ

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯Test_Projectã®ä¸€éƒ¨ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

**ä½œæˆæ—¥**: 2026å¹´2æœˆ15æ—¥  
**å®Ÿè£…è€…**: GitHub Copilot (Claude Sonnet 4.5)
